<!doctype html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="widistillh=device-widistillh, initial-scale=1">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <title>4. 调制技术</title> 

    <script src="template.v2.js"></script>
</head>

<body>    
    <distill-header></distill-header>
    <d-title>
        <h1>4. 调制技术</h1>
    </d-title>
<d-article>
    <p>
        音频流水模块本身会产生恒定的音调：这对于管风琴的声音来说可能没问题，但除此之外，它与真实乐器或物理过程产生的声音相比既乏味又不好听。
        真实的声音会随着时间的推移而快速和缓慢地发生变化。 
        为了使合成的声音听起来逼真或至少有趣的东西，那就一定需要包含可以随时间改变流水线参数的机制。 这些是调制源。
    </p>

    <p>
        调制信号主要包含两个基础的来源：
    </p>

    <ul>
        <li>
            演奏者自己通过各种人机界面：按钮、旋钮、滑块等。 
            其中一些是通用的，可以根据音乐家的喜好进行不同的参数分配。 
            这些可能操作界面包括调制轮、弯音轮、所谓的表情踏板，以及来自键盘的力度、释音力度和触后等。 
            有关这些调制接口选项的定义和更多信息，请参阅第 11 章。
        </li>
        <li>
            随着时间的推移自动改变参数的<b>自动调制程序</b>。 这是本节的主要内容。 
            自动调制程序通常有自己的参数，这些参数本身可以由其他调制源调制。
            因此，您可能会看到调制信号的控制链甚至循环。
        </li>
    </ul>


    <p>
        调制信号如何调制参数取决于参数的范围。 
        一些参数，例如音量，是单极的，这意味着它们的范围是 0...N（我们可以将其视为 0...1）。 
        其他参数，例如弯音，可能是双极性的，这意味着它们的范围是 -M... + M（可能简化为 -1/2... + 1/2 或 -1... + 1）。 
        当然，将单极信号映射到双极信号小菜一碟，反之亦然，合成器经常包含这样的操作。
    </p>

    <p>
        另一个问题是参数的分辨率。 一些参数是具有高分辨率的浮点数； 但其他的非常粗粒度。 
        即使一个参数是高分辨率的，它也可以接收的一些可能非常粗糙调制信号——尤其是那些通过 MIDI 提供的信号（第 11.2 节）——，通常只有 7 位 (0...127)。 
        在这种情况下，逐渐改变调制信号将产生拉链效果，因为参数从一个离散值跳跃到下一个。
    </p>
    
    <h2>4.1 低频振荡器</h2>
    <p>
        这是我们的第一个自动参数调制选项。 
        低频振荡器或 LFO 正是写在罐头上的内容：低频重复功能，其输出用于缓慢调制某些参数。 
        缓慢是指 LFO 通常比音频速率慢，因此它小于 50Hz 左右。
        <d-footnote id="1">
            LFO 的一个理想特性是在频域能够提高音频的频率，从而对音频信号进行一种频率调制（或 FM）。 我们将在第 8 章中介绍 FM。
        </d-footnote>。
        LFO 为 1Hz 或更低并不罕见。
    </p>

    <p>
        LFO 可以用来调制很多东西。 例如，如果它被用来改变振荡器的音高，就会产生颤音。 
        同样，如果它用于调节振荡器的音量，也会引起振音。 LFO 通常是双极的，范围可能为 -1... + 1。
    </p>

    <p>
        LFO 通常有多种经典形状，包括正弦波、正方形、三角形，以及锯齿波和斜波，如 Figure-28 所示。
        LFO 有许多参数，至少包括速率或频率，以及幅度或者数值量。
        LFO 的速率也可以由合成器中的时钟定义，或与传入的 MIDI 时钟脉冲的速率同步（参考11章第二节）。
        当音乐家演奏一个新音符时，声音中 LFO 的周期通常会被重置，除非 LFO 被设置为自由方式。
        <d-footnote id="2">
            与音频率振荡器不同，LFO 的相位很重要。当然，我们可以很容易检测到那些调制不同参数的 LFO 的相位异常。
        </d-footnote>。
    </p>

    <p><d-figure><img src="images/figure_28.png" alt="Figure 28" width="100%" /></d-figure> </p>

    <p>
        在单声道合成器中，可能会在释放前一个音符之前按下一个新音符（称为连奏）。 
        在这种情况下，一些 LFO 可能更应该避免重置，因为新的音符可能会被听众认为基本上是前一个音符的延续。
    </p>

    <p>
        一旦你有了一个提供采样节奏的主时钟（参见第 3.3 节），实现 LFO 就非常简单：
        你只需要将采样节奏映射到当前循环位置（0 到 1 之间）。
        你可以用除法来做到这一点，或者你可以通过递增然后截断回到 0 和 1 之间来做到这一点。
        每个都有自己的数值计算的问题。 我在下面的算法实现中选择了后者。
    </p>

    <p><d-figure><img src="images/algorithm_5.png" alt="Algorithm 5" width="100%" /></d-figure> </p>

    <li><b>随机 LFO　振荡器</b></li>
    <p>
        随机振荡器也是常见的一种 LFO。 例如，每个周期它可能会在 -1 和 1 之间选择一个随机的新目标值，
        然后在该周期的过程中，它会逐渐从当前值内插到新值，如 Figure-28 所示。
        我们可以调整新随机目标位置的方差。 实现算法如下：
    </p>

    <p><d-figure><img src="images/algorithm_6.png" alt="Algorithm 6" width="100%" /></d-figure> </p>
    
    <p>
        请注意，我们从 -2...2 中选择 delta 值。 这样，在最大方差下，如果我们当前处于 -1，我们可以转移到任何新的目标值，直到 +1（反之亦然）。 
        随着方差越来越小，我们选择的新目标值将越来越接近当前值。
    </p>

    <li><b>采样和保持器</b></li>

    <P>
        许多合成器还具有称为采样和保持器 (S&H) 的特殊功能，它接受调制输入并产生离散化的调制输出。 
        在每个调制周期的开始，它对输入的当前值进行采样，并且在周期的过程中它只输出那个值，忽略所有后来的输入。 
        与 LFO 一样，采样和保持器可以响应自由运行和连奏。 这是一个简单的实现：
    </P>

    <p><d-figure><img src="images/algorithm_7.png" alt="Algorithm 7" width="100%" /></d-figure> </p>

    <p>
        采样和保持器可以应用于任何调制源以产生调制的“离散化”版本，但将其应用于 LFO 尤其常见。 
        用来离散化锯齿、斜坡、三角形和随机 LFO 波都很常见。
        事实上，采样和保持器经常应用于随机 LFO 振荡器，因此它通常是许多 LFO 发生器中的标准成熟选项。 
        离散化的粗糙度取决于采样率和保持率。Figure-28 显示了在两个不同频率下应用于斜波和随机波的采样和保持器示例。
    </p>

    <h2>4.2 封调（Envelops）</h2>
    <p>
        封调指的是一个时间的函数，被触发之后，从初始值开始，跟随函数变化直到结束。
        最常见的触发形式，就是演奏按下键盘上的一个琴键。
        产生封调函数的软件或者硬件，我们称之为封调生成器。
    </p>

    <li><b>ADSR</b></li>
    <p>
        当前，合成器中最常见的封调形式是 ADSR 即 Attack-Decay-Sustain-Release 封调。
        当ADSR被触发时（通常是由于按下一个琴键），在一个起音时间间隔的过程中，封调开始从一个起始值（通常为 0）上升到一个起音水平（有时固定为 1.0）。
        一旦起音间隔结束，封调就开始在衰减时间的过程中下降到维持水平。 
        此时封调保持在延音电平，直到发生不同的触发（通常是由于演奏者释放了琴键）。 
        然后封调在释放时间间隔的过程中开始衰减到零。
    </p>

    <p>
        ADSR 封调之所以常见，主要原因是非常多的乐器可以用 ADSR 来模拟。
        许多乐器以响亮而刺耳的啸叫开始，然后迅速衰减到更安静、更柔和的持续时期，然后最终消失。 
        这可以用两个 ADSR 封调来进行建模，一个附加到音符的整体音量，另一个附加到滤波器的截止频率。 
        事实上，许多合成器都为这两个目的提供了专用的 ADSR 封调。 
        有趣的是，这两个封调不需要一摸一样：例如，在放大器包络达到其最大音量之前，滤波器封调先达到其最大起音（最亮的声音）是完全合理的。
    </p>

    <p>
        如果 Figure-29 所示，一个 ADSR 封调中的变化率可以是线性的(表现为斜线)，也是可以是指数变化的（或者其他数学形式）。
        线性变化，比较容易实现，上升或者下降的间隔都是固定的；但是指数变化采用变化率作为参数更加简单。
        不管是采用变化率、还是间隔或者时间取决于合成器，不同厂商有不同的选择。
        指数率变化可以在模拟合成器，直接用电路实现，用来拟合特定乐器的指数下降，因此从历史上来，更为常见。
    </p>

    <p><d-figure><img src="images/figure_29.png" alt="Figure-29" width="30%" /></d-figure> </p>

    

</d-article>
<d-appendix> 
    <d-footnote-list></d-footnote-list>    
    <d-citation-list></d-citation-list>       
</d-appendix>

<distill-footer></distill-footer>

</body>
